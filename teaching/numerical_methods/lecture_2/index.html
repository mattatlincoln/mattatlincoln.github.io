
<!DOCTYPE html>
<html>
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1" />

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <title>System of Linear Equations 1</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

  <link rel="stylesheet" type="text/css" href="https://jsxgraph.uni-bayreuth.de/distrib/jsxgraph.css" />
  <script type="text/javascript" src="https://jsxgraph.uni-bayreuth.de/distrib/jsxgraphcore.js"></script>  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

  <!-- General and theme style sheets -->
  <link rel="stylesheet" href="../../../revealjs/css/reveal.css">
  <link rel="stylesheet" href="../../../revealjs/css/theme/beige.css" id="theme">

  <!-- If the query includes 'print-pdf', include the PDF print sheet -->
  <script>
    if( window.location.search.match( /print-pdf/gi ) ) {
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = '../../../revealjs/css/print/pdf.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    }

  </script>

  <!--[if lt IE 9]>
  <script src="../../../revealjs//lib/js/html5shiv.js"></script>
<![endif]-->

<!-- Loading the mathjax macro -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<!-- Load mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<!-- MathJax configuration -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {
  inlineMath: [ ['$','$'], ["\\(","\\)"] ],
  displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
  processEscapes: true,
  processEnvironments: true
},
// Center justify equations in code and markdown cells. Elsewhere
// we use CSS to left justify single line equations in code cells.
displayAlign: 'center',
"HTML-CSS": {
styles: {'.MathJax_Display': {"margin": 0}},
linebreaks: { automatic: true }
}
});
</script>
<!-- End of mathjax configuration -->

<!-- Get Font-awesome from cdn -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.css">

<!-- Custom stylesheet, it must be in the same directory as the html file -->
<link rel="stylesheet" href="../custom.css">

</head>
<body>

  <div class="reveal">
    <div class="slides">

      <section data-background-image="https://upload.wikimedia.org/wikipedia/commons/3/3c/Mona_Lisa_eigenvector_grid.png">
        <h2 style="color:white;" id="Numerical Methods Week 5">Numerical Methods Week 5<a class="anchor-link" href="#Numerical Methods Week 5">&#182;</a></h2>
        <h1 style="color:white;" id="System of Linear Equations 1">System of Linear Equations 1<a class="anchor-link" href="#System of Linear Equations 1">&#182;</a></h1>
        <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
        8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">

        <p>We move on to the second main topic: <a href=''>systems of linear equations</a>.</p>
        <p>Learning outcomes:</p>
      </div>
      <br>
      <div style="background-color:Gold; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
      8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
      <li> Recall methods of solution of inhomogeneous systems of linear equations.</li>
      <li> Elimination methods, Gauss elimination, Gauss-Jordan elimination .</li>
      <li> Implement and use Gauss-Jordan Elimination to solve systems of equations.</li>	
    </div>
    <br>
    <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
    8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">

    <h3>Matt Watkins mwatkins@lincoln.ac.uk<a class="anchor-link" href="#Matt Watkins">&#182;</a></h3>
  </div>
</section>

<section>
  <h2 id="Solving a system of Equations">Solving a system of Equations<a class="anchor-link" href="#Solving a system of Equations">&#182;</a></h2>
  <p>Suppose we want to solve a system of equations $\textbf{A}x = b$</p>
  <p>$\textbf{A}$ is a matrix of coefficients of our unknowns, $x$, and $b$ is a vector of constants.</p>
  <p>Explicitly this can be written (for a set of 4 equations with 4 unknowns) as:<br> 
   \[ \left( \begin{array}{cccc}
   a_{00} & a_{01} & a_{02} & a_{03}\\ 
   a_{10} & a_{11} & a_{12} & a_{13}\\ 
   a_{20} & a_{21} & a_{22} & a_{23}\\ 
   a_{30} & a_{31} & a_{32} & a_{33}\\ 
   \end{array} \right)
   \left( \begin{array}{c}
   x_0\\
   x_1\\
   x_2\\
   x_3\\
   \end{array} \right)
   =
   \left( \begin{array}{c}
   b_0\\
   b_1\\
   b_2\\
   b_3\\
   \end{array} \right) \]	<br>
 </p>
 <p class='fragment'> It can be useful to rewrite this as an <a href='https://en.wikipedia.org/wiki/Augmented_matrix'>augmented matrix</a><br><br> 
   \[ \left( \begin{array}{cccc|c}
   a_{00} & a_{01} & a_{02} & a_{03} & b_0\\ 
   a_{10} & a_{11} & a_{12} & a_{13} & b_1\\ 
   a_{20} & a_{21} & a_{22} & a_{23} & b_2\\ 
   a_{30} & a_{31} & a_{32} & a_{33} & b_3\\ 
   \end{array} \right)\]
 </p>
</section>

<section>
  <section>
   <h2 id="Gaussian Elimination">Gaussian Elimination<a class="anchor-link" href="#Gaussian Elimination">&#182;</a></h2>    
   <h3 id="Triangularization">Triangularization<a class="anchor-link" href="#Triangularization">&#182;</a></h3>      
   <p>We reduce the augmented matrix to <a href='https://en.wikipedia.org/wiki/Row_echelon_form'>row echelon form</a>. Let us take an initial augmented matrix as: 
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     1 & 3 & 2 & 4 & 17\\ 
     3 & 1 & 3 & 1 & 18\\ 
     1 & 3 & 4 & 2 & 27\\ 
     \end{array} \right) \]
   </p>
   <p class=fragment>
     pivoting around row 0, we remove all entries below the diagonal entry in column 0,
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     0 & 2 & 0 & 5 & 12\\ 
     0 & -2 & -3 & 4 & 3\\ 
     0 & 2 & 2 & 3 & 22\\ 
     \end{array} \right) \]
   </p>
 </section>
 <section>
   <p>
     Matrix after pivoting around row 0	
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     0 & 2 & 0 & 5 & 12\\ 
     0 & -2 & -3 & 4 & 3\\ 
     0 & 2 & 2 & 3 & 22\\ 
     \end{array} \right) \]
   </p><p class=fragment>
     Then pivoting around row 1 we remove elements below the diagonal in column 1,
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     0 & 2 & 0 & 5 & 12\\ 
     0 & 0 & -3 & 9 & 15\\ 
     0 & 0 & 2 & -2 & 10\\ 
     \end{array} \right) \]
   </p><p class=fragment>	  
     pivoting around row 2
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     0 & 2 & 0 & 5 & 12\\ 
     0 & 0 & -3 & 9 & 15\\ 
     0 & 0 & 0 & 4 & 20\\ 
     \end{array} \right) \]
   </p>
 </section>
</section>

<section>
  <h2 id="Gaussian Elimination">Gaussian Elimination<a class="anchor-link" href="#Gaussian Elimination">&#182;</a></h2>    
  <h3 id="Back substitution">Back substitution<a class="anchor-link" href="#Back substitution">&#182;</a></h3>
  <p> From the triangularized augmented matrix we can then solve for $x$
   \[ \left( \begin{array}{cccc|c}
   2 & 2 & 4 & -2 & 10\\ 
   0 & 2 & 0 & 5 & 12\\ 
   0 & 0 & -3 & 9 & 15\\ 
   0 & 0 & 0 & 4 & 20\\ 
   \end{array} \right) \]
 </p>
 <p class=fragment>Starting at row 3, only the coefficient of $x_3$ is non-zero. Converting the augmented notation to real equations using the last row we have
   $$
   0 \cdot x_0 + 0 \cdot x_1 + 0 \cdot x_2 + 4 \cdot x_3 = 20 \implies x_3 = 5
   $$
 </p>
 <p class=fragment>Then we can work up the rows
   \[\begin{align*}
   0 \cdot x_0 + 0 \cdot x_1 + -3 \cdot x_2 + 9 \cdot x_3 & = 15 \\
   0 \cdot x_0 + 0 \cdot x_1 + -3 \cdot x_2 + 9 \cdot 5 & = 15 \implies x_2 = 10	  
   \end{align*}\]
 </p>
 <p class=fragment>Now row 2
   \[\begin{align*}
   0 \cdot x_0 + 2 \cdot x_1 + 0 \cdot x_2 + 5 \cdot x_3 & = 12 \\
   0 \cdot x_0 + 2 \cdot x_1 + 0 \cdot 10 + 9 \cdot 4 & = 12 \implies x_1 = -6.5
   \end{align*}\]
 </p>
 <p class=fragment>And finally
   \[\begin{align*}
   2 \cdot x_0 + 2 \cdot -6.5 + 4 \cdot 10 + -2 \cdot 4 & = 10 \implies x_0 = -3.5
   \end{align*}\]
 </p>
</section>

<section>
  <h2 id="Gaussian Elimination: Code">Gaussian Elimination: Code<a class="anchor-link" href="#Gaussian Elimination: Code">&#182;</a></h2>
  <p>Here is the main bit of code to carry out Gaussian elimination on a system of equations$\textbf{A}x =b$</p>
  <pre>
   <code>void gauss_elim(double (&a)[rows][cols]) {
    double coeff;
    double x[rows];
    for (int i =0; i &lt rows-1; i++) {
    for (int j = i+1; j &lt rows; j++) {
    coeff = a[j][i]/a[i][i];
    for (int k = i; k &lt cols; k++) {
    a[j][k] -= a[i][k]*coeff;
  }
}
}
// now back substitute
for (int i=rows-1;i>=0;i--) {
x[i] = a[i][cols-1];
for (int j=i+1; j&ltcols-1; j++) {
x[i] -= a[i][j]*x[j];
}
x[i] /= a[i][i];
}
}
</code>
</pre>
<p>
  This performs the triangularization, then the back substitution.
  A full working code can be found on Blackboard for you to work with.
</p>
</section>    

<section>
  <h2 id="Visualization">Visualization<a class="anchor-link" href="#Visualization">&#182;</a></h2>
  <p>It is not so obvious how to conveniently plot you data in C++, here is one way, using Latex</p>
  <pre>
   <code>
    #include "stdafx.h"
    #include &ltiostream>
    #include &ltfstream>

    int main() {
    std::ofstream fout("mytex.tex");
    fout << "\\documentclass[11pt]{article}\n\n"
    << "% graphics\n"
    << "\\usepackage{tikz}\n"
    << "\\usepackage{pgfplots}\n"
    << "\\pgfplotsset{compat=1.12}\n"
    << "\\usepgfplotslibrary{fillbetween}\n\n\n"
    << "\\begin{document}\n"
    << "\\begin{tikzpicture}\n\n"
    << "\\pgfplotsset{\n"
    << "scale only axis,\n"
    << "}\n\n"
    << "\\begin{axis}[\n"
    << "xlabel = $x$,\n"
    << "ylabel = $y$,\n"
    << "samples = 100,\n"
    << "]\n"
    << "\\addplot[only marks] table{\n";         

    // write data points
    fout << "0.0 1.0\n 1.0 2.0\n";

    fout << "};\n"
    << "\\addplot[][domain =-1.5:10]{\n";
    // write function
    fout << "1.5*x + 2*x^2";

    fout << "};\n"
    << "\\end{axis}\n"
    << "\\end{tikzpicture}\n"
    << "\\end{document}\n";

    std::cout << "wrote " << "mytex.tex\n\n";
  }
</code></pre>
<p>This writes a file "mytex.tex" that you can compile in TeXnicCenter - currently graphing isn't working as the pgfplots module needs adding.
The pdf can be exported to Word or an image if wanted.</p>
<p>You can add points and define curves (and many more things) using <a href="http://pgfplots.sourceforge.net/">PGFPlots</a>.</p>
<p>We'll use Latex output to view the matrix operations clearly.</p>
</section>

<section>
  <h2 id="Gaussian Elimination: Code">Gaussian Elimination: Code<a class="anchor-link" href="#Gaussian Elimination: Code">&#182;</a></h2>
  <p>Here is the full code (also on Blackboard), it includes some extra code to produce tex output.</p>
  <pre>
   <code>#include &ltiostream>
    #include &ltfstream>

    void latex_header(std::ofstream &myout) {
    myout &lt&lt "\\documentclass[11pt]{article}\n\n"
    &lt&lt "\\begin{document}\n";
  }

  void latex_footer(std::ofstream &myout) {
  myout &lt&lt "\\end{document}\n";
}

template &ltint rows, int cols>
void output_matrix(std::ofstream &myout, double (&a)[rows][cols]) {
myout &lt&lt "\\[ \\left( \\begin{array}{";
for (int i =0; i&lt cols-1;i++) {
myout &lt&lt "c";
}
myout &lt&lt "|c}\n";
for (int i =0; i &lt rows; i++) {
for (int j =0; j &lt cols; j++) {
myout &lt&lt a[i][j];
if (j &lt cols-1) myout &lt&lt " & ";
}
myout &lt&lt "\\\\ \n";
}
myout &lt&lt "\\end{array} \\right) \\]\n";
}

template &ltint rows, int cols>
void gauss_elim(std::ofstream &myout, double (&a)[rows][cols]) {
double coeff;
double x[rows];
for (int i =0; i &lt rows-1; i++) {
for (int j = i+1; j &lt rows; j++) {
coeff = a[j][i]/a[i][i];
for (int k = i; k &lt cols; k++) {
a[j][k] -= a[i][k]*coeff;
}
}
myout &lt&lt "\n pivoting around row " &lt&lt i &lt&lt "\n\n";
output_matrix(myout,a);
}
// now back substitute
myout &lt&lt "Back substituting to find $x$:\n";
for (int i=rows-1;i>=0;i--) {
x[i] = a[i][cols-1];
for (int j=i+1; j&ltcols-1; j++) {
x[i] -= a[i][j]*x[j];
}
x[i] /= a[i][i];
}
myout &lt&lt "\\[x^T = \\left( \\begin{array}{cccc}\n";
for (int i = 0; i &lt rows; i++) {
myout &lt&lt x[i];
if (i &lt rows-1) myout &lt&lt " & ";
}
myout &lt&lt "\\end{array} \\right) \\]\n";
}

int main() {
std::ofstream myout("Gauss-Elim.tex");
int n = 4;
double a[4][5] = {{2,2,4,-2,10},
{1,3,2,4,17},
{3,1,3,1,18},
{1,3,4,2,27},
};

latex_header(myout);
myout &lt&lt "Initial matrix is: \n\n";
output_matrix(myout, a);

gauss_elim(myout, a);

latex_footer(myout);
}	  
</code>
</pre>
<p>
	The tex output should be written to 'Gauss-Elim.tex' in the directory of your project. If you find that in the file browser and double click on it, it should open in TexNicCenter.
	Check the output is to pdf, then press &ltctrl>+&ltF7> to compile it.
</p>
</section>    

<section>
  <h2 id="Gauss Elimination">Gauss Elimination<a class="anchor-link" href="#Gauss Elimination">&#182;</a></h2>
  <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
  <p>Find the solutions of
   \[
   \begin{align*}
   3x_0  +  4x_1 - 7x_2 & = 23\\
   7x_0  -   x_1 + 2x_2 & = 14\\
   x_0  + 10x_1 - 2x_2 & = 33\\
   \end{align*}
   \]
 </p>
 <p>Can you find the solutions of
   \[
   \begin{align*}
   1x_0 + 2x_1 + 3x_2 & = 1\\
   4x_0 + 5x_1 + 6x_2 & = 2\\
   7x_0 + 8x_1 + 9x_2 & = 3\\
   \end{align*}
   \]??<br><br>
 </p>
 <p>
   Add a counter into your code to estimate how many floating point operations it performs.<br>
   - How does the count vary with the size of the problem?
 </p>

</div>
</section>

<section>
  <section>
   <h2 id="Gauss-Jordan Elimination">Gauss-Jordan Elimination<a class="anchor-link" href="#Gauss-Jordan Elimination">&#182;</a></h2>
   <p>Guass-Jordan elimination is very similar to Gauss elimination. Instead of triangularization, we make a completely diagonal matrix. Or more exactly we reduce the augmented matrix to $\textbf{reduced}$ row echelon form.
     Initial matrix is: 
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     1 & 3 & 2 & 4 & 17\\ 
     3 & 1 & 3 & 1 & 18\\ 
     1 & 3 & 4 & 2 & 27\\ 
     \end{array} \right) \]
     as before
   </p><p class='fragment'> The first step is the same:	  
     pivoting around row 0
     \[ \left( \begin{array}{cccc|c}
     2 & 2 & 4 & -2 & 10\\ 
     0 & 2 & 0 & 5 & 12\\ 
     0 & -2 & -3 & 4 & 3\\ 
     0 & 2 & 2 & 3 & 22\\ 
     \end{array} \right) \]
   </p><p>
   </section>
   <section>
     <p> The first step is the same:	  
       pivoting around row 0
       \[ \left( \begin{array}{cccc|c}
       2 & 2 & 4 & -2 & 10\\ 
       0 & 2 & 0 & 5 & 12\\ 
       0 & -2 & -3 & 4 & 3\\ 
       0 & 2 & 2 & 3 & 22\\ 
       \end{array} \right) \]
     </p><p class='fragment'> But now, pivoting around row 1, we remove entries above $\textbf{and}$ below the diagonal of column 1
       \[ \left( \begin{array}{cccc|c}
       2 & 0 & 4 & -7 & -2\\ 
       0 & 2 & 0 & 5 & 12\\ 
       0 & 0 & -3 & 9 & 15\\ 
       0 & 0 & 2 & -2 & 10\\ 
       \end{array} \right) \]
     </p><p class='fragment'>This continues
       pivoting around row 2
       \[ \left( \begin{array}{cccc|c}
       2 & 0 & 0 & 5 & 18\\ 
       0 & 2 & 0 & 5 & 12\\ 
       0 & 0 & -3 & 9 & 15\\ 
       0 & 0 & 0 & 4 & 20\\ 
       \end{array} \right) \]
     </p>
   </section>
   <section>
     <p>And finally, pivoting around row 3
       \[ \left( \begin{array}{cccc|c}
       2 & 0 & 0 & 0 & -7\\ 
       0 & 2 & 0 & 0 & -13\\ 
       0 & 0 & -3 & 0 & -30\\ 
       0 & 0 & 0 & 4 & 20\\ 
       \end{array} \right) \]
     </p><p  class='fragment'>We can then divide each row by the final coefficients to get: 
       \[ \left( \begin{array}{cccc|c}
       1 & 0 & 0 & 0 & -3.5\\ 
       0 & 1 & 0 & 0 & -6.5\\ 
       -0 & -0 & 1 & -0 & 10\\ 
       0 & 0 & 0 & 1 & 5\\ 
       \end{array} \right) \]
       And we can just read the solutions for $x$ off.
     </p>
   </section>
 </section>

 <section>
  <section>
   <h2 id="Gauss-Jordan Elimination for Matrix Inversion">Gauss-Jordan Elimination for Matrix Inversion<a class="anchor-link" href="#Gauss-Jordan Elimination for Matrix Inversion">&#182;</a></h2>
   <p>We can solve the equation $\textbf{AX} = \textbf{I}$ using exactly the same method:
     \[ \left( \begin{array}{ccc|ccc}
     2 & 1 & 1 & 1 & 0 & 0\\ 
     1 & 0 & -1 & 0 & 1 & 0\\ 
     2 & -1 & 2 & 0 & 0 & 1\\ 
     \end{array} \right) \]

     pivoting around row 0

     \[ \left( \begin{array}{ccc|ccc}
     2 & 1 & 1 & 1 & 0 & 0\\ 
     0 & -0.5 & -1.5 & -0.5 & 1 & 0\\ 
     0 & -2 & 1 & -1 & 0 & 1\\ 
     \end{array} \right) \]

     pivoting around row 1

     \[ \left( \begin{array}{ccc|ccc}
     2 & 0 & -2 & 0 & 2 & 0\\ 
     0 & -0.5 & -1.5 & -0.5 & 1 & 0\\ 
     0 & 0 & 7 & 1 & -4 & 1\\ 
     \end{array} \right) \]
   </p>
 </section>
 <section>
   <p>
     pivoting around row 2
     \[ \left( \begin{array}{ccc|ccc}
     2 & 0 & 0 & 0.285714 & 0.857143 & 0.285714\\ 
     0 & -0.5 & 0 & -0.285714 & 0.142857 & 0.214286\\ 
     0 & 0 & 7 & 1 & -4 & 1\\ 
     \end{array} \right) \]

     Final matrix is:

     \[ \left( \begin{array}{ccc|ccc}
     1 & 0 & 0 & 0.142857 & 0.428571 & 0.142857\\ 
     -0 & 1 & -0 & 0.571429 & -0.285714 & -0.428571\\ 
     0 & 0 & 1 & 0.142857 & -0.571429 & 0.142857\\ 
     \end{array} \right) \]
   </p>
   <p> The RHS of the augmented matrix is $\textbf{A}^{-1}$
   </p>
 </section>
</section>
<section>
  <h2 id="Gauss-Jordan Elimination">Gauss-Jordan Elimination<a class="anchor-link" href="#Gauss-Jordan Elimination">&#182;</a></h2>
  <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
  <p>Alter the code for Gauss elimination to instead perform Gauss-Jordan elimination.<br>
   - You should change the second loop so that it goes over all rows.<br>
   - You should add an `if` statement to skip the row with the same index as the column you are working on.<br>
   - When the matrix is diagonal, divide each row by the value of the remaining diagonal element to get the identity matrix and $x$.<br>
 </p>
</div>
<div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
<p> - Solve the same matrix problems as before and check the result is the same.</p>
<p> - Find the inverse of the matrix
 \[ \left( \begin{array}{cccc}
 2 & 2 & 4 & -2 \\ 
 1 & 3 & 2 & 4 \\ 
 3 & 1 & 3 & 1\\ 
 1 & 3 & 4 & 2 \\ 
 \end{array} \right) \]
 <br>
 Check your solution is correct by multiplying the original and inverse matrices.
</p>	    
<p>- Add a counter to the Gauss-Jordan elimination routine. How does it compare to Gauss Elimination?
</p>
</div>
</section>

<section>
  <h2 id="Summary and Further Reading">Summary and Further Reading<a class="anchor-link" href="#Summary and Further Reading">&#182;</a></h2>
  <p>You should be reading additional material to provide a solid background to what we do in class</p>
  <p>All the textbooks contain sections on solving linear equations, for instance chapter 2 of <a href="http://www.nrbook.com/a/bookcpdf.php">Numerical Recipes</a>.</p>
  <h3>Homework</h3>
  <p>Before next week read about extra steps that can be performed to improve elimination methods.</p>
  <p>Read about LU decomposition of a square matrix.</p>
  <p>revise Eigenvalues and Eigenvectors, ready for next week.</p>
</section>

<section>
  <h2 id="Snake">Snake<a class="anchor-link" href="#Snake">&#182;</a></h2>
  <p>Use the arrow keys</p>
  <form><input type="button" onClick="startGame()" value="start game"></form>
  <div id="snakebox" class="jxgbox" style="width:500px; height:500px; overflow:hidden; "></div>
  <script>
    var snakeBoard = JXG.JSXGraph.initBoard('snakebox',{boundingbox: [0, 20, 20, 0],grid:true});
    var snake = {
      points : [[10,11],[10,10]],
      dir : [1,0],
      size: 2,
      newSize: 2,
      speed: 50,
      hitSelf: function(x,y) {
        for (var i=0;i<this.size-1;i++) {
          if (x==this.points[0][i]) if (y==this.points[1][i]) { return true; }
        }
        return false;
      }
    }
    var curve = snakeBoard.create('curve', snake.points , {strokeWidth:20,strokeOpacity:0.5});
    var point = snakeBoard.create('point', [
      Math.round(Math.random()*18)+1,Math.round(Math.random()*18)+1], 
      {strokeColor:'#4CADD4',fillColor:'#4CADD4',strokeWidth:10,name:' '});
    var t = snakeBoard.create('text', [2,1,function() { return snake.size; }], {fontSize:28});

    var setRandomPosition = function()  {
      point.setPositionDirectly(JXG.COORDS_BY_USER,
        [Math.round(Math.random()*18)+1,
        Math.round(Math.random()*18)+1]);
    }
    var keyDown = function (Evt) {
      var code;
      if (!Evt) Evt = window.event;
      if (Evt.which) {
        code = Evt.which;
      } else if (Evt.keyCode) {
        code = Evt.keyCode;
      }
        // 37: left,  38: up,  39: right,  40: down
        if (code==37) { snake.dir = [-1,0]; return false;}
        else if (code==38) { snake.dir = [0,1]; return false;}
        else if (code==39) { snake.dir = [1,0]; return false;}
        else if (code==40) { snake.dir = [0,-1]; return false;}
        return true;
      }
      document.onkeydown = keyDown;

      var crawl = function() {
        if (snake.size>=snake.newSize) {
          snake.points[0].shift();
          snake.points[1].shift();
        }
        var x = snake.points[0][snake.points[0].length-1]+snake.dir[0];
        snake.points[0].push(x);
        var y = snake.points[1][snake.points[1].length-1]+snake.dir[1];
        snake.points[1].push(y);
        snake.size = snake.points[0].length;
        snakeBoard.update();
        if (x>=20 || x<=0 || y>=20 || y<=0 || snake.hitSelf(x,y)) {
          alert('Game over');
        } else {
          if (x==point.X()) if (y==point.Y()) {
            snake.newSize += 5;
            snake.speed -= 10;
            setRandomPosition();
            snakeBoard.update();
          }
          setTimeout(crawl,snake.speed);
        }
      }

      var startGame = function () {
        snake.points[0].splice(0,snake.size,10,11);
        snake.points[1].splice(0,snake.size,10,10);
        snake.dir = [1,0];
        snake.size = 2;
        snake.newSize = 2;
        snake.speed = 200;
        setRandomPosition();
        crawl();
      } 
    </script>
  </section>

</div> <!-- slides -->
</div> <!-- reveal -->

<script>

  require(
  {
      // it makes sense to wait a little bit when you are loading
      // reveal from a cdn in a slow connection environment
      waitSeconds: 15
    },
    [
    "../../../revealjs//lib/js/head.min.js",
    "../../../revealjs//js/reveal.js"
    ],

    function(head, Reveal){

      // Full list of configuration options available here: https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        mouseWheel: false,
        center: false,
        scroll: true,

        // Parallax background image
        //parallaxBackgroundImage: 'https://github.com/mattatlincoln/mattatlincoln.github.io/blob/master/images/CaF2_zoom.jpg?raw=true',
        // Parallax background size
        parallaxBackgroundSize: '2100px 900px', // CSS syntax, e.g. "2100px 900px

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
        { src: "../../../revealjs//lib/js/classList.js",
        condition: function() { return !document.body.classList; } },
        { src: "../../../revealjs//plugin/notes/notes.js",
        async: true,
        condition: function() { return !!document.body.classList; } }
        ]
      });

      var update = function(event){
        if(MathJax.Hub.getAllJax(Reveal.getCurrentSlide())){
          MathJax.Hub.Rerender(Reveal.getCurrentSlide());
        }
      };

      Reveal.addEventListener('slidechanged', update);

      var update_scroll = function(event){
        $(".reveal").scrollTop(0);
      };

      Reveal.addEventListener('slidechanged', update_scroll);

    }
    );
  </script>

</body>

</html>
