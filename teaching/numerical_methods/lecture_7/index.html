
<!DOCTYPE html>
<html>
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1" />

  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

  <title>Questions</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/default.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

 <link rel="stylesheet" type="text/css" href="https://jsxgraph.uni-bayreuth.de/distrib/jsxgraph.css" />
 <script type="text/javascript" src="https://jsxgraph.uni-bayreuth.de/distrib/jsxgraphcore.js"></script>  
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

  <!-- General and theme style sheets -->
  <link rel="stylesheet" href="../../../revealjs/css/reveal.css">
  <link rel="stylesheet" href="../../../revealjs/css/theme/beige.css" id="theme">

  <!-- If the query includes 'print-pdf', include the PDF print sheet -->
  <script>
  if( window.location.search.match( /print-pdf/gi ) ) {
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = '../../../revealjs/css/print/pdf.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  }

  </script>

  <!--[if lt IE 9]>
  <script src="../../../revealjs//lib/js/html5shiv.js"></script>
  <![endif]-->

  <!-- Loading the mathjax macro -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <!-- Load mathjax -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
  <!-- MathJax configuration -->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true,
      processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
      styles: {'.MathJax_Display': {"margin": 0}},
      linebreaks: { automatic: true }
    }
  });
  </script>
  <!-- End of mathjax configuration -->

  <!-- Get Font-awesome from cdn -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.css">

  <!-- Custom stylesheet, it must be in the same directory as the html file -->
  <link rel="stylesheet" href="../custom.css">

</head>
<body>

<div class="reveal">
  <div class="slides">

    <section data-background-image="https://upload.wikimedia.org/wikipedia/commons/d/db/LIGO_measurement_of_gravitational_waves.svg">
      <h2 style="color:black;" id="Numerical Methods Week 6">Numerical Methods Week 6<a class="anchor-link" href="#Questions Week 6">&#182;</a></h2>
      <h1 style="color:black;" id="Questions">Questions<a class="anchor-link" href="#Questions">&#182;</a></h1>
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
		  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">	
	<p>Learning outcomes:</p>
      </div>
      <br>
      <div style="background-color:Gold; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
		  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
        <li> Practice using some of the methods we have covered so far.</li>
      </div>
      <br>
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
		  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
 
       <h3>Matt Watkins mwatkins@lincoln.ac.uk<a class="anchor-link" href="#Matt Watkins">&#182;</a></h3>
      </div>
    </section>

    <section>
      <h2 id="Practice Questions"><a class="anchor-link" href="#Practice Questions">&#182;</a></h2>
      <p>The following slides contain a series of questions for you to work through to reinforce your knowledge of the material covered so far.</p>
    </section>

    <section>
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
                  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
	<p>Find the determinant of
	  \[
	  \begin{align*}
	  3x_0  +  4x_1 - 7x_2 & = 23\\
	  7x_0  -   x_1 + 2x_2 & = 14\\
	  x_0  + 10x_1 - 2x_2 & = 33\\
	  \end{align*}
	  \]
	</p>
	<p>Can you find the determinant of
	  \[
	  \begin{align*}
	  1x_0 + 2x_1 + 3x_2 & = 1\\
	  4x_0 + 5x_1 + 6x_2 & = 2\\
	  7x_0 + 8x_1 + 9x_2 & = 3\\
	  \end{align*}
	  \]<br>
	</p>
	<p>Adapt your code to also perform LU decomposition</p>
	<p> - Find the inverse of the matrix using LU decomposition 
	  \[ \left( \begin{array}{cccc}
	  2 & 2 & 4 & -2 \\ 
	  1 & 3 & 2 & 4 \\ 
	  3 & 1 & 3 & 1\\ 
	  1 & 3 & 4 & 2 \\ 
	  \end{array} \right) \]
	  <br>
	  Check your solution is correct by comparison to Gauss-Jordan.
	  Note you can also get the determinant from LU decomposition.
	</p>	    
      </div>
    </section>
    
    <section>
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
                  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
	<p>Find the eigenvalues of the following matrices using the QR decomposition code on Bb (or write your own of course):
	<p>
	  \begin{pmatrix}
	   1 & -1 & -1 & -1\\
	  -1 &  2 &  0 &  0\\
	  -1 &  0 &  3 &  1\\
	  -1 &  0 &  1 &  4
	\end{pmatrix}.
	</p>
	<p>
	  \begin{pmatrix}
	  1 & 0 & 0 & 1\\
	  0 &  1 &  0 & 1/2\\
	  0 &  0 &  1 & 1/4\\
	  1 &  1/2 &  1/4 &  1
	  \end{pmatrix}.
	</p>
	<p>
	  Check that your eigenvalues are eigenvalues by running Gauss elimination on the equation $(\textbf{A} - \lambda_i \textbf{I}) \textbf{x} = 0 $.
	  The augmented matrix should be of reduced rank, and you can deduce the eigenvectors from the output.
	</p>
	<p>
	  Check that an eigenvector you found is an eigenvector with eigenvalue $\lambda_i$ by direct multiplication.
	</p>
	<p>
	  Modify the code to output the condition number of a matrix. The condition number is the ratio of the largest to smallest eigenvalue. This controls how numerically stable inversion of the matrix is.
	</p>
    </section>

    <section>
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
                  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
	<p>Find the minimum of the quadratic form
	  $$
	  f(\textbf{x}) = \frac{1}{2}\textbf{x}^T \textbf{A x} - \textbf{b}^T\textbf{x}
	  $$
	</p>
	<p>Pen and paper - by looking at the individual equations show that the minimum of $f(\textbf{x})$ is given by the solution of $\textbf{Ax} - \textbf{b}$ = 0</p>
	<p>Find the minimum of $f(\textbf{x})$ where $\textbf{x}^T = (-2,-1,0,1,2)$, $A_{ij} = 2 \delta_{ij}$ and $b_i = 1$ where $\delta_{ij}$ is the <a href='https://en.wikipedia.org/wiki/Kronecker_delta'>Kronecker delta</a>.</p>
      </div>
    </section>

    <section>
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
                  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
	<p>Matrix functions
	</p>
      </div>
    </section>

    
    <section>
      	<p>Some differential equations can be solved numerically as follows (more details next term).</p>
	<p>We can approximate a function $y = f(x)$ on a grid of $n$ points that are spaced by $\Delta x$.</p>
	<p>We can approximate derivatives of $y$ by finite differences
	  $$
	  \frac{\text{d}^2 y}{\text{d} x^2} \Big|_i
	  = \frac{(y_{i+1}-y_{i})/\Delta x - (y_{i}-y_{i-1})/\Delta x}{\Delta x} = \frac{y_{i+1} - 2y_i + y_{i-1}}{\Delta x^2}
	  $$
	</p>
	<p>In matrix form we can write this as
	  $$
	  \frac{1}{\Delta x^2}
	  \begin{pmatrix}
	  -2 &  0 &  0 &  0 & 0 & 0 & 0 & 0 \\
	   1 & -2 &  1 &  0 & 0 & 0 & 0 & 0 \\
	   0 & \ddots & \ddots & \ddots & 0 & 0 & 0 & 0\\
	   0 & 0 & 1 & -2 &  1 &  0 & 0 & 0  \\
	   0 & 0 & 0 & \ddots & \ddots & \ddots & 0 & 0\\
	   0 & 0 & 0 & 0 & 0 & 1 & -2 &  1   \\
	  0  &  0 &  0 &  0 & 0 & 0 & 0 & -2 \\
	  \end{pmatrix}
	  \begin{pmatrix}
	  y_0\\
	  y_1\\
	  \vdots\\
	  y_i\\
	  \vdots\\
	  y_{n-2}\\
	  y_{n-1}\\
	  \end{pmatrix}
	  $$
	</p>
	</section><section>
	<p>
	  We can write
	  $$
	  \frac{\text{d}^2 y}{\text{d} x^2} = g(x)
	  $$
	  as
	  $$
	  \begin{pmatrix}
	  -2 &  0 &  0 &  0 & 0 & 0 & 0 & 0 \\
	   1 & -2 &  1 &  0 & 0 & 0 & 0 & 0 \\
	   0 & \ddots & \ddots & \ddots & 0 & 0 & 0 & 0\\
	   0 & 0 & 1 & -2 &  1 &  0 & 0 & 0  \\
	   0 & 0 & 0 & \ddots & \ddots & \ddots & 0 & 0\\
	   0 & 0 & 0 & 0 & 0 & 1 & -2 &  1   \\
	  0  &  0 &  0 &  0 & 0 & 0 & 0 & -2 \\
	  \end{pmatrix}
	  \begin{pmatrix}
	  y_0\\
	  y_1\\
	  \vdots\\
	  y_i\\
	  \vdots\\
	  y_{n-2}\\
	  y_{n-1}\\
	  \end{pmatrix}
	  =
	  \begin{pmatrix}
	  -2 y_L\\
	  g_1 \Delta x^2\\
	  \vdots\\
	  g_i \Delta x^2\\
	  \vdots\\
	  g_{n-2} \Delta x^2\\
	  -2 y_R\\
	  \end{pmatrix}
	  $$
	  where $y_L$ and $y_R$ are the values of $y$ at the left and right boundaries.
	</p>
	
      <div style="background-color:Lavender; margin-left: 20px; margin-right: 20px; padding-bottom: 8px; padding-left:
                  8px; padding-right: 8px; padding-top: 8px; border-radius: 25px;">
	<p>Check you agree with the matrix form</p>
	<p>Find a solution for $y$ in the interval [0,1] when:
	  <br> - $g(x) = x, y_L = 0.2, y_R=1.5$
	  <br> - $g(x_{n/2}) = 1/\Delta x$, all other $g_i = 0$ and $y_L = 0, y_R=0$<br>
	  in each case try with $n=10, 100, 500$</p>
	<p>Which method of solution is fastest?</p>
	<p>Fit your (sections of your) data to a polynomial.</p>
      </div>
    </section>
    
    <section>
      <h2 id="Summary and Further Reading">Summary and Further Reading<a class="anchor-link" href="#Summary and Further Reading">&#182;</a></h2>
      <p>You should be reading additional material to provide a solid background to what we do in class</p>
      <p>All the textbooks contain sections on solving linear equations, for instance chapter 2 of <a href="http://www.nrbook.com/a/bookcpdf.php">Numerical Recipes</a>.</p>
      <h3>Homework</h3>
      <p>There is a new portfolio item on blackboard - this is due in 2 weeks time, 16:00 on 16th Novermber.</p>
      <p>Marks and feedback for portfolio item 1 is available on Bb.</p>
    </section>

    <section>
      <h2 id="Snake">Snake<a class="anchor-link" href="#Snake">&#182;</a></h2>
      <p>Use the arrow keys</p>
      <form><input type="button" onClick="startGame()" value="start game"></form>
      <div id="snakebox" class="jxgbox" style="width:500px; height:500px; overflow:hidden; "></div>
      <script>
    var snakeBoard = JXG.JSXGraph.initBoard('snakebox',{boundingbox: [0, 20, 20, 0],grid:true});
    var snake = {
        points : [[10,11],[10,10]],
        dir : [1,0],
        size: 2,
        newSize: 2,
        speed: 50,
        hitSelf: function(x,y) {
            for (var i=0;i<this.size-1;i++) {
                if (x==this.points[0][i]) if (y==this.points[1][i]) { return true; }
            }
            return false;
        }
    }
    var curve = snakeBoard.create('curve', snake.points , {strokeWidth:20,strokeOpacity:0.5});
    var point = snakeBoard.create('point', [
        Math.round(Math.random()*18)+1,Math.round(Math.random()*18)+1], 
        {strokeColor:'#4CADD4',fillColor:'#4CADD4',strokeWidth:10,name:' '});
    var t = snakeBoard.create('text', [2,1,function() { return snake.size; }], {fontSize:28});

    var setRandomPosition = function()  {
        point.setPositionDirectly(JXG.COORDS_BY_USER,
            [Math.round(Math.random()*18)+1,
            Math.round(Math.random()*18)+1]);
    }
    var keyDown = function (Evt) {
        var code;
        if (!Evt) Evt = window.event;
        if (Evt.which) {
            code = Evt.which;
        } else if (Evt.keyCode) {
            code = Evt.keyCode;
        }
        // 37: left,  38: up,  39: right,  40: down
        if (code==37) { snake.dir = [-1,0]; return false;}
        else if (code==38) { snake.dir = [0,1]; return false;}
        else if (code==39) { snake.dir = [1,0]; return false;}
        else if (code==40) { snake.dir = [0,-1]; return false;}
        return true;
    }
    document.onkeydown = keyDown;

    var crawl = function() {
        if (snake.size>=snake.newSize) {
            snake.points[0].shift();
            snake.points[1].shift();
        }
        var x = snake.points[0][snake.points[0].length-1]+snake.dir[0];
        snake.points[0].push(x);
        var y = snake.points[1][snake.points[1].length-1]+snake.dir[1];
        snake.points[1].push(y);
        snake.size = snake.points[0].length;
        snakeBoard.update();
        if (x>=20 || x<=0 || y>=20 || y<=0 || snake.hitSelf(x,y)) {
            alert('Game over');
        } else {
            if (x==point.X()) if (y==point.Y()) {
                snake.newSize += 5;
                snake.speed -= 10;
                setRandomPosition();
                snakeBoard.update();
            }
            setTimeout(crawl,snake.speed);
        }
    }
    
    var startGame = function () {
        snake.points[0].splice(0,snake.size,10,11);
        snake.points[1].splice(0,snake.size,10,10);
        snake.dir = [1,0];
        snake.size = 2;
        snake.newSize = 2;
        snake.speed = 200;
        setRandomPosition();
        crawl();
     } 
	</script>
    </section>
    
  </div> <!-- slides -->
</div> <!-- reveal -->

  <script>

  require(
    {
      // it makes sense to wait a little bit when you are loading
      // reveal from a cdn in a slow connection environment
      waitSeconds: 15
    },
    [
      "../../../revealjs//lib/js/head.min.js",
      "../../../revealjs//js/reveal.js"
    ],

    function(head, Reveal){

      // Full list of configuration options available here: https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        mouseWheel: false,
        center: false,
        scroll: true,

        // Parallax background image
        //parallaxBackgroundImage: 'https://github.com/mattatlincoln/mattatlincoln.github.io/blob/master/images/CaF2_zoom.jpg?raw=true',
        // Parallax background size
        parallaxBackgroundSize: '2100px 900px', // CSS syntax, e.g. "2100px 900px

        theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
        transition: Reveal.getQueryHash().transition || 'linear', // default/cube/page/concave/zoom/linear/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
          { src: "../../../revealjs//lib/js/classList.js",
          condition: function() { return !document.body.classList; } },
          { src: "../../../revealjs//plugin/notes/notes.js",
          async: true,
          condition: function() { return !!document.body.classList; } }
        ]
      });

      var update = function(event){
        if(MathJax.Hub.getAllJax(Reveal.getCurrentSlide())){
          MathJax.Hub.Rerender(Reveal.getCurrentSlide());
        }
      };

      Reveal.addEventListener('slidechanged', update);

      var update_scroll = function(event){
        $(".reveal").scrollTop(0);
      };

      Reveal.addEventListener('slidechanged', update_scroll);

    }
  );
  </script>

</body>

</html>
